<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:RailReader2.ViewModels"
        xmlns:v="using:RailReader2.Views"
        xmlns:c="using:RailReader2.Controls"
        x:Class="RailReader2.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="railreader2"
        Width="1200" Height="900"
>

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <DockPanel>
        <!-- Menu Bar -->
        <v:MenuBarView DockPanel.Dock="Top" DataContext="{Binding}" />

        <!-- Tab Bar -->
        <v:TabBarView DockPanel.Dock="Top" DataContext="{Binding}" />

        <!-- Status Bar -->
        <v:StatusBarView DockPanel.Dock="Bottom" DataContext="{Binding}" />

        <!-- Main Content -->
        <Panel>
            <!-- Outline Panel -->
            <SplitView IsPaneOpen="{Binding ShowOutline}"
                       DisplayMode="Inline"
                       PanePlacement="Left"
                       OpenPaneLength="220">
                <SplitView.Pane>
                    <v:OutlinePanel DataContext="{Binding}" />
                </SplitView.Pane>
                <SplitView.Content>
                    <Panel>
                        <!-- Layered PDF viewport with compositor-driven camera -->
                        <v:ViewportPanel Name="Viewport">
                            <Panel Name="CameraPanel" RenderTransformOrigin="0%,0%">
                                <Panel Name="PagePanel"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Top">
                                    <v:PdfPageLayer Name="PageLayer" />
                                    <v:SearchHighlightLayer Name="SearchLayer" />
                                    <v:AnnotationLayer Name="AnnotationLayer" />
                                    <v:RailOverlayLayer Name="OverlayLayer" />
                                </Panel>
                            </Panel>
                        </v:ViewportPanel>

                        <!-- Minimap overlay -->
                        <v:MinimapControl Name="Minimap"
                                          IsVisible="{Binding ShowMinimap}" />

                        <!-- Search bar overlay -->
                        <v:SearchBarView Name="SearchBar"
                                         IsVisible="{Binding ShowSearch}"
                                         VerticalAlignment="Top"
                                         HorizontalAlignment="Right"
                                         Margin="0,4,16,0" />

                        <!-- Radial annotation menu (screen-space overlay) -->
                        <Canvas Name="RadialMenuCanvas"
                                IsHitTestVisible="{Binding IsRadialMenuOpen}"
                                IsVisible="{Binding IsRadialMenuOpen}">
                            <c:RadialMenu Name="RadialMenuControl"
                                          Canvas.Left="{Binding RadialMenuX}"
                                          Canvas.Top="{Binding RadialMenuY}" />
                        </Canvas>

                        <!-- Welcome text when no document open -->
                        <TextBlock Name="WelcomeText"
                                   Text="Open a PDF file (Ctrl+O)"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   FontSize="18"
                                   Foreground="White"
                                   IsVisible="{Binding !Tabs.Count}" />
                    </Panel>
                </SplitView.Content>
            </SplitView>
        </Panel>
    </DockPanel>
</Window>
